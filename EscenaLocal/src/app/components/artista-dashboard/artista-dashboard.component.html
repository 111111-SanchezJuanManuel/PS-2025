<div class="container my-4">

  <div class="d-flex justify-content-between align-items-center mb-3">
    <h2 class="mb-0">Dashboard del artista</h2>

    <a class="btn btn-outline-secondary"
       routerLink="/perfil">
      Volver al perfil
    </a>
  </div>

  <div *ngIf="loading" class="text-muted">Cargando...</div>

  <div *ngIf="error" class="alert alert-danger">
    {{ error }}
  </div>

  <ng-container *ngIf="!loading && !error && dashboard">

    
    <div class="row g-3 mb-4">
      <div class="col-md-3">
        <div class="card p-3">
          <small class="text-muted">Total asistentes</small>
          <div class="fs-4 fw-bold">{{ formatNumero(dashboard.kpis?.totalEntradas) }}</div>
        </div>
      </div>

      <div class="col-md-3">
        <div class="card p-3">
          <small class="text-muted">Eventos en período</small>
          <div class="fs-4 fw-bold">{{ formatNumero(dashboard.kpis?.totalEventos) }}</div>
        </div>
      </div>

      <div class="col-md-3">
        <div class="card p-3">
          <small class="text-muted">Promedio por evento</small>
          <div class="fs-4 fw-bold">
            {{ formatNumero(dashboard.kpis?.promedioEntradasPorEvento) }}
          </div>
        </div>
      </div>

      <div class="col-md-3" *ngIf="dashboard.kpis?.mejorEventoNombre">
        <div class="card p-3">
          <small class="text-muted">Mejor evento</small>
          <div class="fw-bold">{{ dashboard.kpis?.mejorEventoNombre }}</div>
          <small class="text-muted">
            {{ formatNumero(dashboard.kpis?.mejorEventoEntradas) }} asistentes
          </small>
        </div>
      </div>
    </div>

    
    <section class="mb-4" *ngIf="entradasPorDiaChart.length">
      <h4>Asistentes por día</h4>

      <ngx-charts-bar-vertical
        [view]="view"
        [results]="entradasPorDiaChart"
        [xAxis]="true"
        [yAxis]="true"
        [legend]="false"
        [showXAxisLabel]="true"
        [showYAxisLabel]="true"
        [xAxisLabel]="'Fecha'"
        [yAxisLabel]="'Asistentes'"
        [roundEdges]="true"
        [xAxisTickFormatting]="formatFechaEjeX"
        [yAxisTickFormatting]="formatNumero">
      </ngx-charts-bar-vertical>
    </section>

    
    <section class="mb-4" *ngIf="entradasPorTipoChart.length">
      <h4>Entradas por tipo</h4>

      <ngx-charts-pie-chart
        [view]="view"
        [results]="entradasPorTipoChart"
        [legend]="true"
        [labels]="true">
      </ngx-charts-pie-chart>
    </section>

    
    <section class="mb-4" *ngIf="rankingEventosChart.length">
      <h4>Ranking de eventos (asistencia)</h4>

      <ngx-charts-bar-horizontal
        [view]="view"
        [results]="rankingEventosChart"
        [xAxis]="true"
        [yAxis]="true"
        [legend]="false"
        [showXAxisLabel]="true"
        [showYAxisLabel]="true"
        [xAxisLabel]="'Asistentes'"
        [yAxisLabel]="'Evento'"
        [xAxisTickFormatting]="formatNumero">
      </ngx-charts-bar-horizontal>
    </section>

  </ng-container>
</div>


