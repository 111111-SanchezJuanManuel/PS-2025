<div class="container mt-4" style="max-width: 420px">
  <div class="card p-3 shadow">
    <form (ngSubmit)="onSubmit()" #registerForm="ngForm">
      <!-- Datos de usuario -->
      <div class="mb-3">
        <label class="form-label">Usuario</label>
        <input
          name="username"
          [(ngModel)]="model.username"
          required
          class="form-control"
        />
      </div>

      <div class="mb-3">
        <label class="form-label">Email</label>
        <input
          type="email"
          name="email"
          [(ngModel)]="model.email"
          required
          class="form-control"
        />
      </div>

      <div class="mb-3">
        <label class="form-label">Contraseña</label>
        <input
          type="password"
          name="password"
          [(ngModel)]="model.password"
          required
          class="form-control"
        />
      </div>

      <!-- Rol -->
      <div class="mb-3">
        <label class="form-label">Rol</label>
        <select
          class="form-select"
          name="rol"
          [(ngModel)]="selectedRolId"
          required
        >
          <option [ngValue]="null">Seleccione un rol</option>
          <option *ngFor="let r of roles" [value]="r.id">
            {{ r.rol }}
          </option>
        </select>
      </div>

      <!-- Campos comunes Artista/Productor -->
      <div class="mb-3">
        <label class="form-label">Nombre</label>
        <input
          name="nombre"
          [(ngModel)]="nombre"
          required
          class="form-control"
        />
      </div>

      <div class="mb-3">
        <label class="form-label">Representante</label>
        <input
          name="representante"
          [(ngModel)]="representante"
          class="form-control"
        />
      </div>

      <div class="mb-3">
        <label class="form-label">Teléfono representante</label>
        <input
          name="telefono_representante"
          [(ngModel)]="telefono_representante"
          class="form-control"
        />
      </div>

      <div class="mb-3">
        <label class="form-label">Red social</label>
        <input
          name="red_social"
          [(ngModel)]="red_social"
          class="form-control"
        />
      </div>

      <!-- SOLO si es artista, mostrar géneros -->
      <div class="mb-3" *ngIf="esArtista()">
        <label class="form-label">Género musical</label>
        <select
          class="form-select"
          name="idGenero"
          [(ngModel)]="idGenero"
          [required]="esArtista()"
        >
          <option [ngValue]="null">Seleccione un género</option>
          <option *ngFor="let g of generos" [value]="g.id">
            {{ g.genero }}
          </option>
        </select>
      </div>

      <!-- Imagen opcional -->
      <div class="mb-3" *ngIf="modoRegistro">
        <label class="form-label">Foto de perfil (opcional)</label>
        <input
          type="file"
          accept="image/*"
          (change)="onFileSelected($event)"
          class="form-control"
        />
      </div>

      <button class="btn-orange w-100" [disabled]="registerForm.invalid">
        Registrarme
      </button>
    </form>

    <div *ngIf="error" class="alert alert-danger mt-2">{{ error }}</div>

    <div class="text-center mt-3">
      <span>¿Ya tenés cuenta?</span>
      <a
        class="text-primary fw-bold"
        (click)="irAlLogin()"
        style="cursor: pointer"
      >
        Iniciar Sesión
      </a>
    </div>
  </div>
</div>
